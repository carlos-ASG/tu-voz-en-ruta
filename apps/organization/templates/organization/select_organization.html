{% extends 'organization/base.html' %}

{% block title %}Seleccionar Organización{% endblock %}

{% block header_title %}Selección de Organización{% endblock %}
{% block header_subtitle %}Por favor selecciona la organización en la que viajaste{% endblock %}

{% block content %}
<form method="post" action="{% url 'organization:select_organization' %}" class="survey-form" id="selectUnitForm">
    {% csrf_token %}
    
    <!-- Sección: Selección de unidad -->
    <section class="form-section unit-section">
        <h2 class="section-title">
            <span class="section-number">1</span>
            Información de la organización
        </h2>
        
        {% if form.errors %}
        <div class="form-errors">
            {{ form.errors }}
        </div>
        {% endif %}
        
        <div class="form-group">
            {{ form.organization.label_tag }}
            {{ form.organization }}
            {% if form.organization.help_text %}
            <small class="help-text">{{ form.organization.help_text }}</small>
            {% else %}
            <small class="help-text">Selecciona la organización</small>
            {% endif %}
            {% if form.organization.errors %}
            <div class="field-errors">
                {{ form.organization.errors }}
            </div>
            {% endif %}
        </div>
    </section>

    <!-- SECCIÓN: Verificación reCAPTCHA -->
    {{ form.captcha.errors }}
    {{ form.captcha }}

    <!-- Botón de continuar -->
    <div class="form-actions">
        <button type="submit" class="btn btn-primary">
            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
            Continuar a la encuesta
        </button>
    </div>
</form>
    
    <!-- Enlace al Super-Admin (esquema público) -->
    <p class="admin-link-container" style="text-align:center;">
        <a href="/super-admin/" class="admin-link" title="Super Admin">
            <svg class="admin-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </svg>
        </a>
    </p>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('selectUnitForm');
        const unitSelect = document.getElementById('organization_id');
        
        // Validación básica del lado del cliente
        form.addEventListener('submit', function(e) {
            if (!unitSelect.value) {
                e.preventDefault();
                alert('Por favor selecciona una organización');
                unitSelect.focus();
                return false;
            }
        });
    });
</script>
{% endblock %}
